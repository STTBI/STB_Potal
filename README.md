<div align="center">

# STB_Portal
![image](https://github.com/user-attachments/assets/d68f1db0-5aa0-4011-a287-64e3cb4fc477)

스파르타 내일배움캠프에서 플랫포머 퍼즐게임 포탈1을 레퍼런스로 진행한 팀 프로젝트입니다.

</div>
  
----
  
## 📌 프로젝트 개요
  
- **프로젝트**: 포탈 모작
- **개발환경**: Unity, C#  
- **개발인원**: 5
- **주요기능**:  이동:wasd, 포탈 설치: 마우스 좌,우 클릭, 큐브 잡기: E, 슬로우 모션: F
  
  
----
  
##  팀원 소개 및 역할 분담
  
| 이름 | 역할 | 상세 내용 |
| ---- | ---- | ---- |
| 윤익준 | 포탈 | 들어가면 반대포탈로 나오는 포탈 구현 |
| 변상윤 | 플레이어 | 플레이어 애니메이션 및 물리 구현 |
| 신지은 | 터렛 | 플레이어 감지 및 공격 |
| 서상원 | 퍼즐 | 퍼즐 요소 및 오브젝트 풀 |

----
  
## 📖 맵 설계도
![사조랭이_포탈_와이어프레임_1](https://github.com/user-attachments/assets/a9c95afc-ae0d-4469-b656-d8e46399fcb6)
![사조랭이_포탈_와이어프레임_3](https://github.com/user-attachments/assets/e555ce63-34dc-43aa-92b4-a12b08c0ed78)
![사조랭이_포탈_와이어프레임_2](https://github.com/user-attachments/assets/3903b481-bed4-48ef-8080-b685f5347aa0)

----
  
## 🎥 게임 시연 영상
  
----
  
## 🛠️ 주요 기능
  
## 🛠️ 주요 기능
<h3>터렛 주요 기능</h3>
1. 플레이어 추적 및 공격


터렛 추적: 터렛은 플레이어를 추적하며, 일정 범위 내에서 플레이어의 위치를 감지합니다.

RotateTowardsPlayer(): 터렛이 플레이어를 추적하는 함수.
레이저 감지: 터렛은 레이저를 사용하여 플레이어를 추적하고 감지합니다. 감지 범위 내에 플레이어가 있으면, 레이저를 통해 지속적으로 추적하며 플레이어의 위치를 확인합니다.
Update(): 플레이어를 감지하고 추적하는 로직, 레이저 활성화, 죽은 상태 처리.
DrawLaser(): 레이저를 그리는 함수.
탄환 발사: 플레이어가 감지되면, 터렛은 탄환을 발사하여 공격합니다.
FireBullet(): 탄환 발사 함수.


3. 플레이어 사망 처리

즉시 사망: 플레이어는 터렛의 탄환에 맞으면 즉시 죽게 됩니다. 이를 IsDeath 변수로 처리하여, 플레이어의 상태를 업데이트합니다.
플레이어 상태 관리: 플레이어가 죽은 상태일 경우, 터렛의 레이저가 비활성화됩니다.
OnCollisionEnter(): 탄환이 플레이어와 충돌할 경우 IsDeath를 true로 설정하고 탄환을 비활성화하는 로직.


5. 터렛 물리적 반응
   
터렛 넘어짐: 플레이어의 탄환과 충돌 시, 터렛은 물리적 반응을 보이며 넘어집니다. 이는 Rigidbody 컴포넌트를 사용하여 구현됩니다.
OnCollisionEnter(): 플레이어와 충돌 시 터렛이 물리적으로 반응하고 상태를 변경하는 함수.
터렛 죽음: 터렛이 죽을 직전에는 공격을 멈추고, 일정 시간이 지나면 죽은 상태로 처리됩니다.


7. 오브젝트 풀링
   
탄환 풀링: 탄환은 오브젝트 풀링 방식을 사용하여 관리됩니다. 풀에서 재사용 가능한 탄환을 가져오고, 충돌 후에는 비활성화하여 성능을 최적화합니다.  

<h3>포탈 주요 기능</h3>
1. 포탈 렌더링: 포탈은 두 개 까지만 생성 되고 a포탈을 플레이어가 보면 플레이어가 거울 앞에 선 것 처럼 b포탈 반대편에 플레이어 회전값, 위치값이 반대 돼 있는 포탈 카메라 배치
포탈 카메라가 보고 있는 장면을 a포탈에 렌더링, 플레이어가 이동하거나 회전하면 포탈카메라는 반대로 이동, 회전하여 다른 포탈 뒤로 다른 공간이 있는 것 처럼 보임


2. 포탈 통과: 물체가 a포탈에 들어가면 포탈이 붙어있는 벽의 콜라이더를 무시해 포탈 안으로 들어가는 것 처럼 느껴지게 함, 어느정도 들어가면 b포탈에서 회전값, 속도 등을 유지 한 채로 생성.

----
  
## 🚀 트러블슈팅 (문제해결)
- 터렛
문제: 플레이어가 터렛을 밀면 쓰러져야 하는데 넘어지지 않는 문제 발생
해결: StopTurret()의 isDying을 true로 바꿈
![트러블슈팅 (1)](https://github.com/user-attachments/assets/90d515a7-a9dc-4173-a58c-6404a1e3df37)
문제: 플레이어가 가까이 오면 지정해둔 터렛 상반신이 좌우(rotation y값)으로 움직여야 하는데 위아래(rotation x값)으로 움직이는 문제 발생
해결: 회전할 때 y값만 움직이게  currentRotation.x = -90f으로 고정시킴
![트러블슈팅 (2)](https://github.com/user-attachments/assets/d13caa92-375f-417f-a6e2-713f79cd8448)

- 포탈
문제: 플레이어가 높은곳에서 떨어지며 1번 포탈을 타고 2번 포탈에 나왔을때 기대방향이 아닌 바로 아래로 떨어져 버리는 결과가 나와버림
![포탈 카메라-3](https://github.com/user-attachments/assets/8ead2bb3-54a4-4c73-9dc3-de49f4d94c4b)


원인: PlayerController.Cs에서 플레이어가 받는 중력 가속도를 9.81로 설정해 놓고 그 값 그대로 포탈 1을 타고 포탈 2로 넘어가 증가된 속도력 만큼  -y 방향으로 힘을 줘버려 기댓값 방향이 아닌 결과 값 방향으로 뚝 떨어짐 


해결: PortableObject.cs 의 Warp()메서드에 보면 플레이어의 속도를 바뀐 방향 대로 힘을 주는 코드가 있음


즉, 플레이어가 포탈을 탔다면 PlayerController.Cs  중력가속도 관련 로직을 땅에 닿기 전까지 중단시켜 해결
